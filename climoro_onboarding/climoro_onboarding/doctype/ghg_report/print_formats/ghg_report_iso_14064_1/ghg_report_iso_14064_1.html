<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>{{ doc.report_title or "GHG Emissions and Reductions Report" }}</title>
    <style>
        body {
            font-family: 'Helvetica', 'Arial', sans-serif;
            line-height: 1.4;
            margin: 0;
            padding: 0;
            color: #333;
            background: white;
            font-size: 11pt;
        }
        
        .document-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px;
            background: white;
        }
        
        /* Title Page */
        #title-page {
            text-align: center;
            padding-top: 80px;
            padding-bottom: 30px;
            margin-bottom: 40px;
            min-height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .title-main {
            font-size: 44pt;
            font-weight: 800;
            margin: 0 0 60px 0;
            color: #333;
        }
        /* Meta table under title */
        .meta-wrap {
            text-align: left;
            margin: 0 auto;
            width: 75%;
            max-width: 700px;
        }
        .meta-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12pt;
            border: 1px solid #000;
        }
        .meta-table th,
        .meta-table td {
            border: 1px solid #000;
            padding: 14px 16px;
            vertical-align: middle;
        }
        .meta-table th {
            width: 40%;
            background: #fff;
            text-align: left;
            font-weight: 700;
            color: #111;
        }
        .meta-table td { 
            width: 60%; 
            background: #fff; 
        }
        
        /* Table of Contents - Full Page */
        .toc-container {
            margin: 0;
            padding: 40px;
            page-break-inside: avoid;
            min-height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }
        .toc-container h2 {
            font-size: 24pt;
            font-weight: bold;
            margin-bottom: 40px;
            text-align: center;
            color: #333;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .toc-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .toc-item {
            margin: 12px 0;
            font-size: 12pt;
        }
        .toc-item a {
            color: #333;
            text-decoration: none;
            display: block;
            padding: 8px 0;
        }
        .toc-item.level-1 {
            font-weight: bold;
            font-size: 14pt;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }
        .toc-item.level-2 {
            margin-left: 30px;
            font-weight: normal;
            font-size: 12pt;
            color: #555;
        }
        
        /* Section Styling */
        .section {
            margin-bottom: 30px;
            page-break-inside: avoid;
        }
        .section-header {
            font-size: 16pt;
            font-weight: bold;
            color: #333;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .section-content {
            margin-left: 0;
            padding: 0;
            font-size: 11pt;
        }
        
        /* Field Styling */
        .field-group {
            margin-bottom: 15px;
            padding: 0;
        }
        .field-label {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
            font-size: 11pt;
        }
        .field-value {
            margin-bottom: 10px;
            font-size: 11pt;
            line-height: 1.5;
        }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 10pt;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px 12px;
            text-align: left;
            vertical-align: top;
        }
        th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
        
        /* Page breaks */
        .page-break { 
            page-break-before: always; 
        }
        @media print { 
            #title-page { 
                page-break-after: always; 
            }
            .toc-container {
                page-break-after: always;
            }
        }
        
        /* Executive Summary Box */
        .summary-box {
            border: 2px solid #333;
            padding: 20px;
            margin: 30px 0;
            background-color: #f9f9f9;
        }
        .summary-title {
            font-size: 14pt;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        .summary-content p {
            margin: 8px 0;
            font-size: 11pt;
        }
        
        /* Footer */
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ccc;
            text-align: center;
            font-size: 10pt;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="document-container">
        <!-- Title Page -->
        <div id="title-page">
            <div class="title-main">GHG Emissions and Reductions Report</div>
            <div class="meta-wrap">
                <table class="meta-table">
                    <thead>
                        <tr>
                            <th>Reporting Period</th>
                            <td>
                                {% set pf = frappe.utils.formatdate(doc.period_from, "MMMM d, yyyy") if doc.period_from else "" %}
                                {% set pt = frappe.utils.formatdate(doc.period_to, "MMMM d, yyyy") if doc.period_to else "" %}
                                {{ pf }}{% if pf or pt %} – {% endif %}{{ pt }}
                            </td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>Organization Name</th>
                            <td>{{ doc.organization_name or '' }}</td>
                        </tr>
                        <tr>
                            <th>Date of Report</th>
                            <td>{{ frappe.utils.formatdate(doc.date_of_report, "MMMM d, yyyy") if doc.date_of_report else '' }}</td>
                        </tr>
                        <tr>
                            <th>Version</th>
                            <td>{{ doc.version or '' }}</td>
                        </tr>
                        <tr>
                            <th>Prepared By</th>
                            <td>Climoro</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Table of Contents - Full Page -->
        <div class="toc-container">
            <h1>Table of Content</h1>
            <ul class="toc-list">
                <li class="toc-item level-1"><a href="#disclaimer">Disclaimer</a></li>
                <li class="toc-item level-1"><a href="#acknowledgements">Acknowledgements</a></li>
                <li class="toc-item level-1"><a href="#citation-information">Citation Information</a></li>
                <li class="toc-item level-1"><a href="#copyright-notice">Copyright Notice</a></li>
                <li class="toc-item level-1"><a href="#purpose-of-this-report">Purpose of This Report</a></li>
                <li class="toc-item level-1"><a href="#introduction">Introduction</a></li>
                <li class="toc-item level-2"><a href="#organization-description">Organization Description</a></li>
                <li class="toc-item level-2"><a href="#organizational-boundaries">Organizational Boundaries</a></li>
                <li class="toc-item level-2"><a href="#reporting-boundaries">Reporting Boundaries</a></li>
                <li class="toc-item level-1"><a href="#ghg-inventory-results">GHG Inventory Results</a></li>
                <li class="toc-item level-2"><a href="#emissions-and-removals-summary">Emissions and Removals Summary</a></li>
                <li class="toc-item level-2"><a href="#dual-reporting-scope2">Dual Reporting for Scope 2 (if applicable)</a></li>
                <li class="toc-item level-1"><a href="#ghg-reductions-and-removals-enhancements">GHG Reductions and Removals Enhancements</a></li>
                <li class="toc-item level-1"><a href="#data-management-and-quality">Data Management and Quality</a></li>
                <li class="toc-item level-1"><a href="#appendices">Appendices</a></li>
            </ul>
        </div>

        <!-- Disclaimer -->
        <div id="disclaimer" class="section">
            <h1 class="section-header">Disclaimer</h1>
            <div class="section-content">
                {% if doc.disclaimer_text %}
                <div class="field-value">{{ doc.disclaimer_text }}</div>
                {% else %}
                <div class="field-value">This report contains forward-looking statements and estimates based on current information and assumptions. Actual results may differ materially from those projected.</div>
                {% endif %}
            </div>
        </div>

        <!-- Acknowledgements -->
        <div id="acknowledgements" class="section">
            <h1 class="section-header">Acknowledgements</h1>
            <div class="section-content">
                {% if doc.acknowledgements_text %}
                <div class="field-value">{{ doc.acknowledgements_text }}</div>
                {% else %}
                <div class="field-value">We would like to acknowledge the contributions of all stakeholders, team members, and external consultants who have contributed to the preparation of this report.</div>
                {% endif %}
            </div>
        </div>

        <!-- Citation Information -->
        <div id="citation-information" class="section">
            <h1 class="section-header">Citation Information</h1>
            <div class="section-content">
                {% if doc.citation_text %}
                <div class="field-value">{{ doc.citation_text }}</div>
                {% else %}
                <div class="field-value">This report should be cited as: [Organization Name]. (2024). GHG Emissions and Reductions Report. [City, State]: [Organization Name].</div>
                {% endif %}
            </div>
        </div>

        <!-- Copyright Notice -->
        <div id="copyright-notice" class="section">
            <h1 class="section-header">Copyright Notice</h1>
            <div class="section-content">
                {% if doc.copyright_notice_text %}
                <div class="field-value">{{ doc.copyright_notice_text }}</div>
                {% else %}
                <div class="field-value">© 2024 [Organization Name]. All rights reserved. This document may not be reproduced or distributed without prior written permission.</div>
                {% endif %}
            </div>
        </div>

        <!-- Purpose of This Report -->
        <div id="purpose-of-this-report" class="section">
            <h1 class="section-header">Purpose of This Report</h1>
            <div class="section-content">
                {% if doc.purpose_objectives %}
                <div class="field-group">
                    <div class="field-label">Purpose and Objectives</div>
                    <div class="field-value">{{ doc.purpose_objectives }}</div>
                </div>
                {% endif %}
                {% if doc.intended_use_users %}
                <div class="field-group">
                    <div class="field-label">Intended Use and Users</div>
                    <div class="field-value">{{ doc.intended_use_users }}</div>
                </div>
                {% endif %}
                {% if doc.responsibilities %}
                <div class="field-group">
                    <div class="field-label">Responsibilities</div>
                    <div class="field-value">{{ doc.responsibilities }}</div>
                </div>
                {% endif %}
                {% if doc.frequency %}
                <div class="field-group">
                    <div class="field-label">Frequency</div>
                    <div class="field-value">{{ doc.frequency }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Introduction -->
        <div id="introduction" class="section">
            <h1 class="section-header">Introduction</h1>
            <div class="section-content">
                {% if doc.report_type %}
                <div class="field-group">
                    <div class="field-label">Report Type</div>
                    <div class="field-value">{{ doc.report_type }}</div>
                </div>
                {% endif %}
                {% if doc.compliance_statement %}
                <div class="field-group">
                    <div class="field-label">Compliance Statement</div>
                    <div class="field-value">{{ doc.compliance_statement }}</div>
                </div>
                {% endif %}
                {% if doc.verification_status %}
                <div class="field-group">
                    <div class="field-label">Verification Status</div>
                    <div class="field-value">{{ doc.verification_status }}</div>
                </div>
                {% endif %}
                {% if doc.gwp_values %}
                <div class="field-group">
                    <div class="field-label">GWP Values</div>
                    <div class="field-value">{{ doc.gwp_values }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Organization Description -->
        <div id="organization-description" class="section">
            <h1 class="section-header">Organization Description</h1>
            <div class="section-content">
                {% if doc.org_overview %}
                <div class="field-group">
                    <div class="field-label">Organization Overview</div>
                    <div class="field-value">{{ doc.org_overview }}</div>
                </div>
                {% endif %}
                {% if doc.ghg_policies_strategies %}
                <div class="field-group">
                    <div class="field-label">GHG Policies and Strategies</div>
                    <div class="field-value">{{ doc.ghg_policies_strategies }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Organizational Boundaries -->
        <div id="organizational-boundaries" class="section">
            <h1 class="section-header">Organizational Boundaries</h1>
            <div class="section-content">
                {% if doc.ghg_boundary_line %}
                <div class="field-group">
                    <div class="field-label">Boundary Definitions</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Business Unit</th>
                                <th>Location</th>
                                <th>Purpose</th>
                                <th>Included</th>
                                <th>Reason for Exclusion</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for boundary in doc.ghg_boundary_line %}
                            <tr>
                                <td>{{ boundary.business_unit }}</td>
                                <td>{{ boundary.location or "" }}</td>
                                <td>{{ boundary.purpose or "" }}</td>
                                <td>{{ "Yes" if boundary.included else "No" }}</td>
                                <td>{{ boundary.reason_exclusion or "" }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Reporting Boundaries -->
        <div id="reporting-boundaries" class="section">
            <h1 class="section-header">Reporting Boundaries</h1>
            <div class="section-content">
                {% if doc.criteria_significance %}
                <div class="field-group">
                    <div class="field-label">Criteria for Significance</div>
                    <div class="field-value">{{ doc.criteria_significance }}</div>
                </div>
                {% endif %}
                {% if doc.emission_categories %}
                <div class="field-group">
                    <div class="field-label">Emission Categories</div>
                    <div class="field-value">{{ doc.emission_categories }}</div>
                </div>
                {% endif %}
                {% if doc.exclusions %}
                <div class="field-group">
                    <div class="field-label">Exclusions</div>
                    <div class="field-value">{{ doc.exclusions }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- GHG Inventory Results -->
        <div id="ghg-inventory-results" class="section">
            <h1 class="section-header">GHG Inventory Results</h1>
            <div class="section-content">
                {% if doc.base_year %}
                <div class="field-group">
                    <div class="field-label">Base Year</div>
                    <div class="field-value">{{ doc.base_year }}</div>
                </div>
                {% endif %}
                {% if doc.changes_to_base_year %}
                <div class="field-group">
                    <div class="field-label">Changes to Base Year</div>
                    <div class="field-value">{{ doc.changes_to_base_year }}</div>
                </div>
                {% endif %}
                
                <!-- Emissions and Removals Summary -->
                <div id="emissions-and-removals-summary" class="field-group">
                    <div class="field-label">Emissions and Removals Summary</div>
                    {% if doc.ghg_inventory_line %}
                    <table>
                        <thead>
                            <tr>
                                <th>Category (ISO 14064-1)</th>
                                <th>Scope</th>
                                <th>Direct/Indirect</th>
                                <th>GHG Type</th>
                                <th>Emissions (tCO2e) - Current Year</th>
                                <th>Emissions (tCO2e) - Base Year</th>
                                <th>Change (%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for line in doc.ghg_inventory_line %}
                            <tr>
                                <td>{{ line.iso_category or "" }}</td>
                                <td>{{ line.scope or "" }}</td>
                                <td>{{ line.direct_or_indirect or "" }}</td>
                                <td>{{ line.ghg_type or "" }}</td>
                                <td>{{ line.emissions_current or 0 }}</td>
                                <td>{{ line.emissions_base or 0 }}</td>
                                <td>{{ (line.change_pct or 0) }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <div class="field-value">GHG inventory data will be included in this section.</div>
                    {% endif %}
                </div>
                
                <!-- Dual Reporting for Scope 2 -->
                <div id="dual-reporting-scope2" class="field-group">
                    <div class="field-label">Dual Reporting for Scope 2 (if applicable)</div>
                    {% if doc.ghg_scope2_dual_line %}
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Category 2 Emissions (tCO2e)</th>
                                <th>Total Gross Emissions (tCO2e)</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for line in doc.ghg_scope2_dual_line %}
                            <tr>
                                <td>{{ line.method or "" }}</td>
                                <td>{{ line.category2_emissions or 0 }}</td>
                                <td>{{ line.total_gross_emissions or 0 }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    {% else %}
                    <div class="field-value">Dual reporting data for Scope 2 emissions will be included if applicable.</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- GHG Reductions and Removals Enhancements -->
        <div id="ghg-reductions-and-removals-enhancements" class="section">
            <h1 class="section-header">GHG Reductions and Removals Enhancements</h1>
            <div class="section-content">
                {% if doc.ghg_reduction_line %}
                <table>
                    <thead>
                        <tr>
                            <th>Project/Initiative</th>
                            <th>Type</th>
                            <th>Reduction/Removal (tCO2e)</th>
                            <th>Implementation Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for line in doc.ghg_reduction_line %}
                        <tr>
                            <td>{{ line.project_name or "" }}</td>
                            <td>{{ line.reduction_type or "" }}</td>
                            <td>{{ line.reduction_amount or "0" }}</td>
                            <td>{{ line.implementation_date or "" }}</td>
                            <td>{{ line.status or "" }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="field-value">Information about GHG reduction projects and initiatives will be included in this section.</div>
                {% endif %}
            </div>
        </div>

        <!-- Data Management and Quality -->
        <div id="data-management-and-quality" class="section">
            <h1 class="section-header">Data Management and Quality</h1>
            <div class="section-content">
                {% if doc.activity_data_sources %}
                <div class="field-group">
                    <div class="field-label">Activity Data Sources</div>
                    <div class="field-value">{{ doc.activity_data_sources }}</div>
                </div>
                {% endif %}
                {% if doc.quality_assurance %}
                <div class="field-group">
                    <div class="field-label">Quality Assurance</div>
                    <div class="field-value">{{ doc.quality_assurance }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Appendices -->
        <div id="appendices" class="section">
            <h1 class="section-header">Appendices</h1>
            <div class="section-content">
                <!-- Appendix A: Detailed Calculations -->
                <div id="appendix-a" class="field-group">
                    <div class="field-label">Appendix A: Detailed Calculations</div>
                    {% if doc.appendix_calculations %}
                    <div class="field-value">{{ doc.appendix_calculations }}</div>
                    {% else %}
                    <div class="field-value">Detailed calculation methodologies and supporting data will be included in this appendix.</div>
                    {% endif %}
                </div>

                

                <!-- Appendix C: Glossary -->
                <div id="appendix-c" class="field-group">
                    <div class="field-label">Appendix B: Glossary</div>
                    {% if doc.appendix_glossary %}
                    <div class="field-value">{{ doc.appendix_glossary }}</div>
                    {% else %}
                    <div class="field-value">Definitions of technical terms and abbreviations used throughout this report.</div>
                    {% endif %}
                </div>

                <!-- Appendix D: References -->
                <div id="appendix-d" class="field-group">
                    <div class="field-label">Appendix C: References</div>
                    {% if doc.appendix_references %}
                    <div class="field-value">{{ doc.appendix_references }}</div>
                    {% else %}
                    <div class="field-value">List of sources, standards, and references used in the preparation of this report.</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Executive Summary Box -->
        <div class="summary-box">
            <div class="summary-title">Executive Summary</div>
            <div class="summary-content">
                <p><strong>Organization:</strong> {{ doc.organization_name or "Not specified" }}</p>
                <p><strong>Reporting Period:</strong> {{ doc.period_from or "Start date" }} to {{ doc.period_to or "End date" }}</p>
                <p><strong>Base Year:</strong> {{ doc.base_year or "Not specified" }}</p>
                <p><strong>Compliance:</strong> {{ doc.compliance_statement or "Not specified" }}</p>
                <p><strong>GWP Values:</strong> {{ doc.gwp_values or "Not specified" }}</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>This report was generated on {{ frappe.utils.nowdate() }} using the Climoro Onboarding system.</p>
            <p>For questions or clarifications, please contact the report preparer.</p>
        </div>
    </div>
</body>
</html>
